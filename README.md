# TimeTracker
#### Программа для контроля затраченного времени на поставленные задачи

## Сборка
#### Необходимо:
* ОС: Ubuntu 18.04
* Java 8
* MySQL 5.7
* Gradle
* Postman (для отправки запросов)
* MySQL Workbench (по желанию)

#### Для запуска:
* Склонируйте репозиторий (git clone)
* Откройте файл настроек /src/main/resources/application.properties
  * Для первого запуска для создания БД измените свойство _spring.jpa.hibernate.ddl-auto=update_ на _spring.jpa.hibernate.ddl-auto=create_
  * Так же замените username и password на свои из MySQL (_spring.datasource.password='ваш пароль'_)
* Перейдите в корень проекта и запустите сборку jar-файла из терминала _gradle buildJar_
* Собранный Jar-файл (/build/libs) запустите командой _java -jar 'имя файла.jar'_

#### Изменение параметров Hibernate в исходные:
Если вы не хотите, чтобы БД создавалась каждый раз при запуске приложения, вы можете изменить строку _spring.jpa.hibernate.ddl-auto=create_ на исходную (_spring.jpa.hibernate.ddl-auto=update_) в файле application.properties. При этом БД будет сравниваться с текущими сущностями в коде приложения и, если изменений нет, не будет создаваться заново

## Описание запросов:
### Виды запросов:
* Создание нового пользователя (PUT):
  * _/create_user/{name}_ - по имени
  * _/create_user/{name}/{dateBirthStr}_ - по имени и дате рождения
  * _/create_user/{name}/{dateBirthStr}/{description}_ - по имени, дате рождения и с описанием
* Обновление информации о пользователе (POST):
  * _/user_update_name/{name}/{newName}_ - обновление имени
  * _/user_update_dateBirth/{name}/{dateBirthStr}_ - обновление даты рождения
  * _/user_update_description/{name}/{description}_ - обновление описания
  * _/user_update_all/{name}/{dateBirthStr}/{description} - обновление даты рождения и описания
  * _/user_update_all/{name}/{newName}/{dateBirthStr}/{description} - обновление всех полей пользователя (со сменой текущего имени)
* Добавление (PUT) и завершение задач (POST):
  * _/create_task/{userName}/{descriptionTask}_ - добавление задачи пользователю 'userName'
  * _/complete_task/{userName}/{descriptionTask}_ - завершение задачи пользователю 'userName'
* Вывод информации о трудозатратах (GET):
  * _/show_work_costs/{userName}/{dateA}/{dateB}_ - вывод трудозатрат для конкретного пользователя в указанный промежуток времени
  * _/show_time_intervals/{timeA}/{timeB}_ - вывод временных интервалов, занятых работой у всех пользователей
  * _/show_sum_workcosts/{userName}/{dateA}/{dateB}_ - вывод суммы трудозатрат для конкретного пользователя в указанный промежуток времени
* Удаление информации (DELETE):
  * _/delete_user/{userName}_ - удаление всей информации о пользователе
  * _/clear_tracking_data/{userName}_ - удаление всех задач у конкретного пользователя
 
### Примеры запросов:
* Создание нового пользователя (PUT):
  * _/create_user/Илон Маск_ - в таблицу пользователей будет добавлен пользователь с именем 'Илон Маск'
  * _/create_user/Илон Маск/28.06.1971_ - в таблицу пользователей будет добавлен пользователь с именем 'Илон Маск' и датой рождения 28.06.1971
  * _/create_user/Илон Маск/28.06.1971/Генеральный директор SpaceX_ - в таблицу пользователей будет добавлен пользователь с именем 'Илон Маск', датой рождения 28.06.1971 и описанием 'Генеральный директор SpaceX'
* Обновление информации о пользователе (POST):
  * _/user_update_name/Илон Маск/Илон Рив Маск_ - будет обновлено имя с 'Илон Маск' на 'Илон Рив Маск'
  * _/user_update_dateBirth/Илон Рив Маск/28.06.2071_ - Илону Маску будет присвоена новая дата рождения 
  * _/user_update_description/Илон Рив Маск/Генеральный директор SpaceX и Tesla_ - дополнение описания о пользователе Илон Рив Маск
  * _/user_update_all/Илон Рив Маск/28.06.1971/Генеральный директор SpaceX_ - вернем пользователю его изначальные данные
  * _/user_update_all/Илон Рив Маск/Илон Маск/28.06.1971/Американский предприниматель, миллиардер_ - обновление всех полей у Илона Рива Маска
* Добавление (PUT) и завершение задач (POST):
  * _/create_task/Илон Маск/Разработать TimeTracker с 3.8.2020 по 9.8.2020_ - добавление задачи пользователю 'Илон Маск'
  * _/complete_task/Илон Маск/Разработать TimeTracker с 3.8.2020 по 9.8.2020_ - Илон Маск завершил разработку, но даже он не покрыл приложение тестами
* Вывод информации о трудозатратах (GET):
  * _/show_work_costs/Илон Маск/3.8.2020/9.8.2020_ - выведет трудозатраты в виде связного списка Задача - Затраченное время
  * _/show_time_intervals/3.8.2020/9.8.2020_ - будут выведены временные интервалы, занятые работой у всех пользователей за промежуток с 3.8.2020 по 9.8.2020
  * _/show_sum_workcosts/Илон Маск/3.8.2020/9.8.2020_ - будет выведена сумма трудозатрат в формате 'HH:mm'
* Удаление информации (DELETE):
  * _/delete_user/Илон Маск_ - удаление всей информации о пользователе Илон Маск
  * _/clear_tracking_data/Илон Маск_ - удаление всех задач у пользователя Илона Маск

## Места хранения персистентных данных
* **Журналирование**: при запуске jar файла, log_file.log будет храниться в той же директории
* **База данных** хранится на машине пользователя.

## Примечание
Базу данных желательно перенести на сервер для надежности и возможности получать информацию с разных устройств. 
Задачи в БД хранятся не более месяца после их завершения

